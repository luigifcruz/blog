<!doctype html><html lang=en><head><title>Outernet Receiver with a Wifi Grid Antenna :: Luigi Cruz — Computer Engineering Student. Radio Amateur (PU2SPY). Interested in Rockets, Satellites and Machine Learning.</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I originally bought most of this hardware for the reception of the HRIT &amp;amp; LRIT signals coming from the NOAA’s GOES Geostationary Satellites. Since I’m waiting for more LNAs to arrive from China, I decided to play around with my stock Wi-Fi Grid Antenna and figure out what else I can do with it.
Although this is a 2.4Ghz antenna, the L-Band is close enough for a good SNR. Thus, I can receive almost every signal on the L-Band with this stock antenna, great!"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://test.luigi.ltd/2017-08-04/outernet-receiver-with-a-wifi-grid-antenna/><link rel=stylesheet href=https://test.luigi.ltd/assets/style.css><link rel=stylesheet href=https://test.luigi.ltd/assets/pink.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://test.luigi.ltd/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://test.luigi.ltd/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="https://twitter.com/luigifcruz"><meta name=twitter:creator content="luigifcruz"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Outernet Receiver with a Wifi Grid Antenna :: Luigi Cruz"><meta property="og:description" content="I originally bought most of this hardware for the reception of the HRIT &amp;amp; LRIT signals coming from the NOAA’s GOES Geostationary Satellites. Since I’m waiting for more LNAs to arrive from China, I decided to play around with my stock Wi-Fi Grid Antenna and figure out what else I can do with it.
Although this is a 2.4Ghz antenna, the L-Band is close enough for a good SNR. Thus, I can receive almost every signal on the L-Band with this stock antenna, great!"><meta property="og:url" content="https://test.luigi.ltd/2017-08-04/outernet-receiver-with-a-wifi-grid-antenna/"><meta property="og:site_name" content="Outernet Receiver with a Wifi Grid Antenna"><meta property="og:image" content="https://test.luigi.ltd/favicon.ico"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2017-08-04 00:00:00 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Luigi Cruz</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/projects>Projects</a></li><li><a href=/talks>Talks</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/projects>Projects</a></li><li><a href=/talks>Talks</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://test.luigi.ltd/2017-08-04/outernet-receiver-with-a-wifi-grid-antenna/>Outernet Receiver with a Wifi Grid Antenna</a></h1><div class=post-meta><span class=post-date>2017-08-04</span>
<span class=post-author>::
Luigi Cruz</span></div><div class=post-content><div><p>I originally bought most of this hardware for the reception of the HRIT & LRIT signals coming from the NOAA’s GOES Geostationary Satellites. Since I’m waiting for more LNAs to arrive from China, I decided to play around with my stock Wi-Fi Grid Antenna and figure out what else I can do with it.</p><p><img src=images/weather-outernet.png alt="Outernet Skylark OS 4.4 Weather Visualization"></p><p>Although this is a 2.4Ghz antenna, the L-Band is close enough for a good SNR. Thus, I can receive almost every signal on the L-Band with this stock antenna, great! After some research, I found out that the Outernet is now using an L-Band signal, perfect! The only problem is that this signal is RHCP and these antennas are designed for Wi-Fi linear signals. Consequently, due to the distinct polarization, the Outernet signal will be heavily attenuated. Since this signal is pretty strong and designed to be received with small patch antennas, we shouldn’t have problems to get a decodable SNR with our unoptimized one-meter antenna.</p><h2 id=receiving-the-signal>Receiving the signal<a href=#receiving-the-signal class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Parabolic Antennas are very directional, thus have to remain static for a successful demodulation. Here I used a cheap camera tripod, this isn’t the best solution but should work fine. Here in Americas, the Outernet signal is coming from Inmarsat 4-F3 which is located at 98W. For other locations, please refer to Outernet’s <a href=https://github.com/Outernet-Project/Information/wiki/Satellites,-Frequencies,-and-Coverage-Area>GitHub</a>. I used <a href="https://itunes.apple.com/us/app/spyglass/id332639548?mt=8">SpyGlass</a> iOS App and <a href=http://gpredict.oz9aec.net/>gpredict</a> to help me position the antenna.</p><p><img src=images/wifi-grid-antenna.jpeg alt="Wi-Fi Grid Antenna with the repurposed tripod."></p><p>This signal is very faint, so it needs some amplification to be decodable, this is the perfect job for a Low Noise Amplifier. In this project, I used one <a href="http://www.ebay.com/itm/LNA-50-to-4000MHz-SPF5189-NF-0-6dB-LNA-RF-amplifier-FM-HF-VHF-UHF-Ham-Radio-/152224877094?hash=item23714f4a26:g:SEoAAOSwGtRXxrXk">SPF-5189</a> a low cost easy to find wide-band (50MHz-4000MHz) LNA which <a href=https://twitter.com/lucasteske>Lucas Teske</a> recommended to me. And one crappy LNA from AliExpress that I don’t recommend, but in this case did the job. Another LNA that should work very well is the Adam’s <a href=http://lna4all.blogspot.com.br/>LNA4ALL</a>.</p><p><img src=images/outernet-setup-lna.jpeg alt="LNAs Used."></p><p>Finally, the signal is suitable to work with. Here I’ll use a generic RTL-SDR to keep the budget as low as possible. Please note that some generic RTL-SDR will have problems receiving the upper part of the L-Band particularly when they get hot. If you are planning to buy an RTL-SDR, I strongly recommend the ones from <a href=http://www.rtl-sdr.com/buy-rtl-sdr-dvb-t-dongles/>RTL-SDR Blog</a>. They have TCXO and metal case that should help with shielding and thermal issues.</p><p><img src=images/outernet-americas-signal-fft.png alt="The Outernet Signal being received."></p><h2 id=demodulation>Demodulation<a href=#demodulation class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The current Outernet solution for demodulating and displaying the files is the Skylark OS a Web Based UI that resembles an OS. The latest version is the 4.4 and can be installed in the Raspberry Pi or the C.H.I.P. computer.</p><p><img src=images/outernet-sample-wikipedia-file.png alt="Wikipedia App on the Skylark OS 4.4."></p><p>The demodulation part is bad documented and doesn’t let you adjust the gain or add frequency correction, required for no-TCXO dongles like mine. Even if I could modify these settings, I’m skeptical about the ability of the software to keep up with the frequency deviation caused by the temperature fluctuations, thanks again no-TCXO crystal.</p><p>After some time, the guys from LeanDVB, a lightweight DVB-S Demodulator, published an <a href=http://www.pabr.org/radio/leandvb-satmodem/leandvb-satmodem.en.html>article</a> talking about how to demodulate the Outernet Signal with their software. Exactly what I needed!</p><p>After <a href=https://github.com/pabr/leansdr>installing everything</a> on my laptop, I executed the software with GUI option enabled wait some seconds, and everything worked just fine. Once the LeanDVB locks into the signal, two circles will appear on the PSK symbols window and underscores will start to appear on the Terminal as valid HDLC frames start to being demodulated. Indications that everything is working as planned!</p><p><img src=images/outernet-signal-constellation.png alt="LeanDVB GUI with successful lock."></p><p>Some considerations when doing this:</p><ul><li>Some dongles have a higher frequency offset, so try to adjust the tune values from 38e3 to 42.4e3.</li><li>Add the drift option if your dongle doesn’t have TCXO to compensate the frequency fluctuation over time.</li><li>Adjusting the Frequency Offset (-p) is crucial. If you don’t already know this value, try following this <a href="http://davidnelson.me/?p=371">tutorial</a>.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ rtl_sdr  -f <span style=color:#ae81ff>1539832500</span> -p <span style=color:#ae81ff>78</span> -s 960e3 -g <span style=color:#ae81ff>0</span> - |
$ ./leandvb -f 960e3 --anf <span style=color:#ae81ff>0</span> --tune 42e3 --const BPSK --drift  --sr <span style=color:#ae81ff>4200</span>  --roll-off 0.2  --sampler rrc --rrc-rej <span style=color:#ae81ff>5</span>  --viterbi  --fastlock  --hdlc  --packetized  -v  -d  --gui  &gt; /tmp/hdlcframes.bin
</code></pre></div><h2 id=deployment--decoding>Deployment & Decoding<a href=#deployment--decoding class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Since this signal is narrow and has Viterbi error correction the amount of incoming data is tiny. To make it worse, for the most of the day the data being transmitted will remain the same. Therefore, the next step is to unload this from my main computer and leave it running remotely from a C.H.I.P. or a Raspberry Pi. The installation images and instructions are available <a href=https://archive.outernet.is/images/>here</a>. If you encounter any problem, please refer to the <a href=http://forums.outernet.is/>Outernet Forum</a> or leave a comment here.</p><p>Compiling anything inside the Skylark OS is pretty annoying, so I compiled the LeanDVB on my Raspberry Pi running Raspbian Lite and transferred the binary files to /mnt/downloads folder on my Outernet via the built-in FTP Server. All passwords and usernames by default are “outernet”. You can also download the files I compiled <a href="https://www.dropbox.com/s/j3j6j97851biwaf/leansdr.zip?dl=0">here</a>.</p><p>Once the binary files were in place, I connected my laptop the open Wi-Fi Hotspot created by the Skylark OS called “Outernet” and SSH into the device with the default username and password “outernet”. To execute the binaries, I need to fix the permissions as well as disable the default demodulator using the following commands:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo chmod u+x ./**
$ sudo chmod u+x ./librtlsdr/build/src/**
$ /etc/init.d/S90sdr stop
</code></pre></div><p>Finally, I just need to run the custom LeanDVB demodulator that I tested earlier on my laptop. This command will pipe the HDLC packets directly to the original Skylark OS decoder and provide the final files. Please note that this version has a lower Sample Rate to improve the CPU usage.</p><pre><code>$ ./rtl_sdr  -f 1539832500 -p 78  -s 300e3  -g 0  -  | \
$ ./../../../leandvb.embedded  -f 300e3  --anf 0  --tune 42e3  --const BPSK --drift --sr 4200  --roll-off 0.2  --sampler rrc --rrc-rej 5  --viterbi  --fastlock  --hdlc  --packetized  -v  -d  | \
$ ./uncat /var/run/ondd.data
</code></pre><p>Once the demodulator is up and running, the files received should appear in the Apps available on the WebUI that can be accessed by browsing to any domain while connected on the same network. The name of the current file being downloaded should appear on the Status tab of the Tuner app.</p><p><img src=images/outernet-skylark-demuxing.png alt="Skylark OS Demuxing the Bitstream."></p><h2 id=products--conclusion>Products & Conclusion<a href=#products--conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>I ran this setup for ~25 hours and got a bunch of data. They are all available <a href="https://www.dropbox.com/s/dw0cl0uix1bb1dn/Outernet%20Files.zip?dl=0">here</a> for download. Don’t forget to follow me on <a href=https://twitter.com/luigifcruz>Twitter</a> to receive my latest projects! Some screenshots of the files received:</p><p><img src=images/outernet-wikipedia-sample-2.png alt="Sample Wikipedia File — They are pretty random."></p><p><img src=images/outernet-weather-skylark.png alt="Awesome Weather Data Visualization."></p><p><img src=images/outernet-shortwave-radio-skylark.png alt="Up to date Shortwave Broadcasting Schedule!"></p><p><img src=images/outernet-comunity-content.png alt="Community Submitted Content."></p><p><img src=images/outernet-aprs-messages.png alt="APRS Messages."></p><p><img src=images/outernet-news-feed-skylark.png alt="News Reader."></p><p><img src=images/outernet-games-skylark.png alt=Games!></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://test.luigi.ltd/2018-02-12/reverse-engineering-goes-16-cda-telemetry/><span class=button__icon>←</span>
<span class=button__text>Reverse Engineering GOES-16 CDA Telemetry</span></a></span>
<span class="button next"><a href=https://test.luigi.ltd/2017-07-10/receiving-demodulating-the-meteor-satellite/><span class=button__text>Receiving & Demodulating the Meteor Satellite</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://test.luigi.ltd/assets/main.js></script><script src=https://test.luigi.ltd/assets/prism.js></script></div></body></html>